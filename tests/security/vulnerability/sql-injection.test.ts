import { InputSanitizer } from "../../../src/core/firewall/InputSanitizer"

describe("SQL Injection Protection", () => {
  test("should sanitize SQL injection attempts", () => {
    const maliciousInput = "'; DROP TABLE users; --"
    const sanitized = InputSanitizer.sanitizeSQL(maliciousInput)

    expect(sanitized).not.toContain(";")
    expect(sanitized).not.toContain("DROP")
    expect(sanitized).not.toContain("--")
  })

  test("should validate email format", () => {
    expect(InputSanitizer.validateEmail("test@example.com")).toBe(true)
    expect(InputSanitizer.validateEmail("invalid-email")).toBe(false)
    expect(InputSanitizer.validateEmail("test@")).toBe(false)
  })
})
